## 护理服务应用 开发文档

版本: v1.1.0  |  日期: 2025-09-24

—— 本文档为项目唯一的权威需求与设计说明，请严格按以下要求维护 ——

- 每次变更必须：
  - 递增版本号（遵循语义化版本：v a.b.c）
    - a变更：整体架构变更
    - b变更：功能增加或移除
    - c变更：功能修复或样式修改等小范围变更，不影响项目架构、模块增减
  - 标注变更日期（YYYY-MM-DD）
  - 在"变更记录"中登记变更摘要
  - 同步更新受影响的章节（保持与实现一致）
- 禁止在未更新版本号与日期的情况下提交需求或设计变更。
- 新增/删除字段、接口、流程，需在对应章节明确描述并举例。

---

### 1. 概览

- **应用定位**: 为“护理员”和“参保人”提供服务计划、执行与评价的移动端应用。
- **角色**: 护理员、参保人（两种身份登录视图与权限不同）。
- **核心模块**: 首页、我的、计划详情、评价、特情上报、打卡、服务过程、签退、绑定设备。

---

### 2. 角色与权限

- **护理员**:
  - 查看与操作“今日待服务计划”（请假/推迟/取消）
  - 查看任务统计（今日总任务/已完成/未完成）与评价
  - 功能操作：扫码服务、特情上报、绑定设备、查看参保人
  - 计划详情：扫码服务、请假/推迟/取消
  - 打卡、服务过程执行、签退、设备绑定

- **参保人**:
  - 查看今日服务计划与本月服务计划
  - 查看套餐信息
  - 已完成计划的评价入口
  - 计划详情：推迟/取消、已完成后可评价
  - 我的：个人信息、服务记录总数、个人信息编辑、套餐信息、评价记录

---

### 3. 页面与功能明细

#### 3.1 首页
- **护理员**
  - 今日待服务计划：支持【请假】【推迟】【取消】，各自进入信息填写页
  - 今日任务统计：总任务数/已完成/未完成，可点击进入对应列表；如有评价显示评价
  - 快捷功能：
    - 扫码服务：扫码后跳转打卡页
    - 特情上报：进入“已完成服务且未上报特情”的列表进行操作
    - 绑定设备：扫码绑定流程
    - 查看参保人：查看自己负责服务的参保人信息

- **参保人**
  - 今日服务计划：点击查看详情
  - 本月服务计划：按日历或列表展示
  - 已完成未评价的计划：可前往评价
  - 套餐信息：当前有效套餐与剩余可用项目/时长

#### 3.2 我的
- **护理员**：个人信息展示、服务记录总数、个人信息编辑
- **参保人**：个人信息展示、服务记录总数、个人信息编辑、套餐信息、评价记录

#### 3.3 计划详情
- 状态：未开始/进行中/已完成（未开始可操作，已完成只读）
- **护理员**：查看详情、扫码服务、请假/推迟/取消（跳转填写原因与时间等）
- **参保人**：查看详情、推迟/取消（跳转填写）、已完成后可前往评价

#### 3.4 评价（参保人）
- 填写项：服务态度评分、服务质量评分、文字/录音（可选）
- 入口：
  - 首页“已完成未评价”列表
  - 计划详情（状态=已完成）

#### 3.5 特情上报（护理员）
- 填写项：类别、描述、录音（可选）、关联服务记录
- 入口：
  - 首页快捷入口（筛选已完成且未上报的服务）
  - 服务结束引导页（可跳过）

#### 3.6 打卡（护理员）
- 功能：获取定位、校验定位范围、拍照签到、开始服务
- 触发：扫码服务后进入

#### 3.7 服务过程（护理员）
- 行为：全程录音（需权限）、获取套餐信息、展示护理项目
- 流程：选择项目 → 开始项目 → 结束项目 → 选择下一项 → 全部完成 → 结束本次服务 → 进入签退页面

#### 3.8 签退（护理员）
- 功能：拍照签退、获取定位、同步更新服务记录
- 触发：服务过程全部完成后自动进入
- 流程：拍照 → 获取定位 → 校验定位范围 → 提交签退 → 完成服务

#### 3.9 绑定设备（护理员）
- 流程：扫码 → 展示设备信息 → 获取定位 → 绑定成功

---

### 4. 关键流程（高层时序）

1) 扫码服务→打卡→开始服务→项目逐项执行→结束服务→签退→（可选）特情上报→完成
2) 计划调整（请假/推迟/取消）：在计划详情或首页入口 → 填写原因/时间 → 提交 → 更新计划状态
3) 评价：服务完成→参保人在入口页进入→填写评分与录音→提交→生成评价记录

---

### 5. 数据与状态（简要）

- 计划（Plan）
  - 字段示例：id、参保人id、护理员id、日期、时段、状态（未开始/进行中/已完成/已取消/已推迟/请假）、项目清单、评价状态

- 服务记录（ServiceRecord）
  - 字段示例：id、计划id、开始时间、结束时间、签退时间、录音存储、执行项目明细、是否特情、签退照片、签退定位

- 评价（Review）
  - 字段示例：id、计划id、参保人id、评分（态度/质量）、文字/录音、时间

- 特情（Incident）
  - 字段示例：id、服务记录id、类别、描述、录音、时间

- 设备绑定（DeviceBinding）
  - 字段示例：id、护理员id、设备码、绑定时间、绑定定位

---

### 6. 校验与权限要点（概要）

- 定位与打卡/签退：需在允许范围内方可开始/结束服务；保存拍照凭证。
- 录音权限：进入服务过程前申请；失败需降级提示并允许继续（若业务允许）。
- 操作约束：
  - 已完成的计划仅可查看不可更改。
  - 请假/推迟/取消需写入原因与目标时间（推迟）。
  - 参保人仅能操作自身计划的推迟/取消与评价。

---

### 7. 界面与导航约定（建议）

- 底部 Tab：`首页`、`我的`
- 扫码服务后统一跳转 `打卡` → `服务过程` → `签退`
- 评价/特情作为独立路由从对应入口进入

---

### 8. 后续扩展占位

- 消息通知（计划变更/服务开始提醒/评价提醒）
- 轨迹与时长风控（定位漂移、超时处理）
- 统计看板（护理员/机构维度）

---

### 9. 交互与文案规范（摘录）

- 所有有风险的操作（取消/请假）需二次确认与原因必填。
- 评分采用 1-5 星或 1-10 分制（统一在实现前确定）。
- 日期时间统一使用本地时区；展示格式 YYYY-MM-DD HH:mm。

---

### 10. 变更记录（Changelog）

- v1.1.0 (2025-09-24)
  - 新增签退功能：服务完成后拍照签退并获取定位
  - 更新版本号规则：v a.b.c（a=架构变更，b=功能增减，c=修复/样式）
  - 更新服务流程：服务过程→签退→特情上报
  - 更新数据模型：服务记录增加签退时间、照片、定位字段

- v1.0.0 (2025-09-23)
  - 初始化文档：覆盖角色、页面功能、流程、数据概览与规范。


